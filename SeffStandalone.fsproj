<?xml version="1.0" encoding="utf-8"?>
<Project Sdk="Microsoft.NET.Sdk.WindowsDesktop"> <!--WinDesktop is needed so that rescources work with dotnet build-->

 <PropertyGroup>
    <OutputType>WinExe</OutputType>
    <TargetFrameworks>net472;net50-windows</TargetFrameworks>  <!--  net50, has no Thread.Abort()-->
    <UseWPF>true</UseWPF>    
    <LangVersion>preview</LangVersion>
    
    <NeutralLanguage>en</NeutralLanguage>
    <SatelliteResourceLanguages>en</SatelliteResourceLanguages>    <!--to only have the english resources-->
    <GenerateDocumentationFile>true</GenerateDocumentationFile>

    <RootNamespace>Seff</RootNamespace>
    <AssemblyName>Seff</AssemblyName>
    <AssemblyTitle>Seff</AssemblyTitle>
    <Title>Seff</Title>  
    <Product>Seff</Product>
    <PackageId>Seff</PackageId>  

    <Version>0.9.0.0</Version>
    <AssemblyVersion>0.9.0.0</AssemblyVersion>
    <FileVersion>0.9.0.0</FileVersion>
    <PackageReleaseNotes>First release</PackageReleaseNotes>   

    
    <Authors>GoswinR</Authors>
    <Copyright>Goswin Rothenthal 2021</Copyright>

    <Description>A hostable fsharp scripting editor for Windows based on Avalonedit</Description>
    <ApplicationIcon>Media/logo.ico</ApplicationIcon>
    <Win32Resource>Media/logo.res</Win32Resource>      <!-- Win32Resource for Application Icon in explorer-->    
    
    <Platforms>x64;x86</Platforms>
    <!-- <Configurations>Debug;Release</Configurations> -->
    <Configurations>Release</Configurations>
   
    <!--<DefineConstants>NETFRAMEWORK</DefineConstants>-->
   
    <DefineConstants Condition="'$(TargetFramework)' == 'net472'">NETFRAMEWORK</DefineConstants> 
   
   <OutputPath Condition="'$(Platform)'=='x64'">binStandalone/x64/</OutputPath> 
   <OutputPath Condition="'$(Platform)'=='x86'">binStandalone/x86/</OutputPath>  
  </PropertyGroup>


  <ItemGroup>    
    <PackageReference Update="FSharp.Core" Version="5.0.2" GeneratePathProperty="true" />
    <PackageReference Include="FSharp.Compiler.Service" Version="40.0.0" /> 
    <PackageReference Include="AvalonEditB" Version="1.0.0" />
    <PackageReference Include="AvalonLog" Version="0.3.0" />
    <!-- <PackageReference Include="FsEx.Wpf" Version="1.0.0" /> -->
    
    <!--this reference is needed for tooling only, it might not be installed on host PC. see also https://github.com/fsprojects/IfSharp/issues/213 -->
    <PackageReference Include="NETStandard.Library" Version="2.0.3" GeneratePathProperty="true" />
  </ItemGroup>
  
  <ItemGroup Condition=" '$(TargetFramework)' == 'net472' ">
      <!--
      <Reference Include="AvalonEditB" HintPath="../AvalonEditB/AvalonEditB/bin/Release/net472/AvalonEditB.dll" />
      <Reference Include="AvalonLog" HintPath="../AvalonLog/bin/Release/net472/AvalonLog.dll" />  -->
      <Reference Include="FsEx.Wpf" HintPath="../FsEx.Wpf/bin/Release/net472/FsEx.Wpf.dll" />      
  </ItemGroup>
  <ItemGroup Condition=" '$(TargetFramework)' == 'net50-windows' ">
      <!--
      <Reference Include="AvalonEditB" HintPath="../AvalonEditB/AvalonEditB/bin/Release/net50-windows/AvalonEditB.dll" />
      <Reference Include="AvalonLog" HintPath="../AvalonLog/bin/Release/net50-windows/AvalonLog.dll" />  -->
      <Reference Include="FsEx.Wpf" HintPath="../FsEx.Wpf/bin/Release/net50-windows/FsEx.Wpf.dll" />
  </ItemGroup>     

  <ItemGroup>    
    <None Include="README.md" />
    <EmbeddedResource Include="Media/logo.res" /> <!--  for Application Icon in explorer-->   
    <Resource Include="Media/logo.ico" />    
    <Resource Include="Media/FiraCode-Regular.ttf" />  
    <None Include="FSharpSynatxHighlighterExtended.xshd">    <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>    </None>

    <Compile Include="Src/Util.fs" />
    <Compile Include="Src/ParseFs.fs" />
    <Compile Include="Src/Timer.fs" />
    <Compile Include="Src/Style.fs" />
    <Compile Include="Src/Model.fs" />
    <Compile Include="Src/Config/Hosting.fs" />
    <Compile Include="Src/Config/DefaultCode.fs" />
    <Compile Include="Src/Config/FsiArugments.fs" />
    <Compile Include="Src/Config/OpenTabs.fs" />
    <Compile Include="Src/Config/RecentlyUsedFiles.fs" />
    <Compile Include="Src/Config/AutoCompleteStatistic.fs" />
    <Compile Include="Src/Config/AssemblyReferenceStatistic.fs" />
    <Compile Include="Src/Config/FoldingStatus.fs" />
    <Compile Include="Src/Config/Config.fs" />
    
    <Compile Include="Src/Fsi.fs" />    
    <Compile Include="Src/CompileScript.fs" />

    <Compile Include="Src/Editor/Selection.fs" />
    <Compile Include="Src/Editor/RectangleSelection.fs" />
    <Compile Include="Src/Editor/SwapWords.fs" />  
    <Compile Include="Src/Editor/Commenting.fs" />
    <Compile Include="Src/Editor/DocString.fs" />
    <Compile Include="Src/Editor/SyntaxHighlighting.fs" />
    <Compile Include="Src/Editor/ErrorHighlighter.fs" />
    <Compile Include="Src/Editor/Checker.fs" />
    <Compile Include="Src/Editor/TypeInfo.fs" />
    <Compile Include="Src/Editor/CodeCompletion.fs" />
    <Compile Include="Src/Editor/Foldings.fs" />
    <Compile Include="Src/Editor/SelectedTextTracer.fs" />
    <Compile Include="Src/Editor/BracketColorizer.fs" />
    <Compile Include="Src/Editor/ColumnRulers.fs" />
    <Compile Include="Src/Editor/SwapLines.fs" />
    <Compile Include="Src/Editor/CursorBehaviour.fs" />
    <Compile Include="Src\Editor\KeyboardShortcuts.fs" />
    <Compile Include="Src/Editor/Formating.fs" />
    <Compile Include="Src/Editor/Editor.fs" />
    <Compile Include="Src/Views/Log.fs" />
    <Compile Include="Src/Views/Window.fs" />
    <Compile Include="Src/Views/FileWatcher.fs" />
    <Compile Include="Src/Views/Tab.fs" />
    <Compile Include="Src/Views/Tabs.fs" />
    <Compile Include="Src/Views/TabsAndLog.fs" />
    <Compile Include="Src/Views/Fonts.fs" />
    <Compile Include="Src/Views/StatusBar.fs" />
    <Compile Include="Src/Views/Commands.fs" />
    <Compile Include="Src/Views/Menu.fs" />
    <Compile Include="Src/Views/Seff.fs" />
    
    <Compile Include="Src/Initialize.fs" />    
    <Compile Include="Src/App.fs" />

  </ItemGroup>

   
  <Target Name="CopyFilesOverAfterBuild" BeforeTargets="AfterBuild">

    <!-- <Message Text="Copied FSharp.Core.xml file from $(PkgFSharp_Core) to output dir ." Importance="high"/> -->
    <!-- FSharp.Core.xml is missing otherwise ? to have it as intellisense provider-->
    <Copy SourceFiles="$(PkgFSharp_Core)/lib/netstandard2.0/FSharp.Core.xml" DestinationFiles="$(TargetDir)FSharp.Core.xml" ContinueOnError="false" />

    <!--dll is needed for editor tooling only, it might not be installed on host PC . seee also  https://github.com/fsprojects/IfSharp/issues/213 -->
    <Copy SourceFiles="$(PkgNETStandard_Library)/build/netstandard2.0/ref/netstandard.dll" DestinationFiles="$(TargetDir)netstandard.dll" ContinueOnError="false" />  
    
    <!-- needed for  editor tooling intelisense ? -->
    <Copy SourceFiles="$(PkgNETStandard_Library)/build/netstandard2.0/ref/netstandard.xml" DestinationFiles="$(TargetDir)netstandard.xml" ContinueOnError="false" />  
    
  </Target>

</Project>

